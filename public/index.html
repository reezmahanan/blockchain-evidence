<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EVID-DGC | Blockchain Evidence Management System</title>
    <meta name="description" content="Professional blockchain evidence management for law enforcement, forensic analysts, and legal professionals.">
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/web3@1.8.0/dist/web3.min.js"></script>
    <script src="https://cdn.socket.io/4.7.5/socket.io.min.js"></script>
    <script src="config.js"></script>
    <script src="storage.js"></script>
    <script src="notifications.js"></script>
    <script src="comprehensive-registration.js"></script>
    <script src="indian-apis.js"></script>
    <script src="app.js"></script>
</head>

<body>
    <!-- Navigation Header -->
    <header class="header-nav">
        <div class="navbar-container">
            <div class="nav-brand">
                <i data-lucide="shield-check" class="brand-icon"></i>
                <span>EVID-DGC</span>
            </div>
            <button class="menu-toggle" id="menuToggle">
                <i data-lucide="menu" class="hamburger-icon"></i>
            </button>
            <nav class="nav-menu" id="navMenu">
                <a href="#home" class="nav-link" onclick="scrollToTop()">
                    <i data-lucide="home"></i>
                    <span>Home</span>
                </a>
                <a href="#documentation" class="nav-link" onclick="scrollToSection('documentation')">
                    <i data-lucide="book-open"></i>
                    <span>Documentation</span>
                </a>
                <a href="#contributing" class="nav-link" onclick="scrollToSection('contributing')">
                    <i data-lucide="git-pull-request"></i>
                    <span>Contributing</span>
                </a>
                <a href="#faq" class="nav-link" onclick="scrollToSection('faq')">
                    <i data-lucide="help-circle"></i>
                    <span>Q&A</span>
                </a>
                <a href="#contact" class="nav-link" onclick="scrollToSection('contact')">
                    <i data-lucide="phone"></i>
                    <span>Contact</span>
                </a>
                <a href="https://github.com/Gooichand/blockchain-evidence" target="_blank" class="nav-link">
                    <i data-lucide="github"></i>
                    <span>GitHub</span>
                </a>
                <button class="nav-login-btn" onclick="scrollToSection('login-options')">
                    <i data-lucide="log-in"></i>
                    <span>Login</span>
                </button>
            </nav>
        </div>
    </header>

    <!-- Animated Background -->
    <div class="particles" id="particles"></div>

    <div class="container">
        <!-- Hero Section -->
        <div class="hero-section">
            <div class="hero-content">
                <div class="hero-icon">
                    <i data-lucide="shield-check"></i>
                </div>
                <h1>EVID-DGC</h1>
                <p class="hero-subtitle">Blockchain Evidence Management System</p>
                <p class="hero-description">Secure, transparent, and immutable evidence management for law enforcement and legal professionals.</p>
            </div>
        </div>

        <!-- Login Options -->
        <div class="card" id="login-options">
            <div class="card-header">
                <div class="card-icon">
                    <i data-lucide="log-in"></i>
                </div>
                <h2>Login Options</h2>
                <p>Choose your authentication method</p>
            </div>
            <div class="card-body">
                <div class="login-plan-grid">
                    <div class="plan-option" onclick="scrollToSection('walletSection')">
                        <div class="plan-icon">
                            <i data-lucide="wallet"></i>
                        </div>
                        <h3>MetaMask Wallet</h3>
                        <p>Blockchain authentication</p>
                    </div>
                    <div class="plan-option" onclick="showEmailLogin()">
                        <div class="plan-icon">
                            <i data-lucide="mail"></i>
                        </div>
                        <h3>Email & Password</h3>
                        <p>Traditional login</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Wallet Connection -->
        <div id="walletSection" class="card">
            <div class="card-header">
                <div class="card-icon">
                    <i data-lucide="wallet"></i>
                </div>
                <h2>Connect Wallet</h2>
                <p>Connect your MetaMask wallet to access the system</p>
            </div>
            <div class="card-body">
                <button id="connectWallet" class="btn btn-primary pulse">
                    <i data-lucide="link"></i>
                    Connect MetaMask
                </button>
                <div id="loader" class="loader hidden"></div>
            </div>
        </div>

        <!-- Wallet Status -->
        <div id="walletStatus" class="wallet-status hidden">
            <div class="status-header">
                <i data-lucide="check-circle" class="status-icon success"></i>
                <h3>Wallet Connected!</h3>
            </div>
            <div class="wallet-info">
                <div class="wallet-address-container">
                    <label>Wallet Address:</label>
                    <div id="walletAddress" class="wallet-address"></div>
                </div>
            </div>
            <div class="wallet-actions">
                <button onclick="disconnectWallet()" class="btn btn-outline btn-sm">
                    <i data-lucide="unlink"></i>
                    Disconnect
                </button>
            </div>
        </div>

        <!-- Registration Section -->
        <div id="registrationSection" class="card hidden">
            <div class="card-header">
                <div class="card-icon">
                    <i data-lucide="user-plus"></i>
                </div>
                <h2>User Registration</h2>
                <p>Select your role and complete registration</p>
            </div>

            <!-- Role Selection -->
            <div class="role-selection">
                <h3>Select Your Role</h3>
                <div class="role-grid">
                    <div class="role-card" data-role="1">
                        <div class="role-card-content">
                            <div class="role-icon">
                                <i data-lucide="eye"></i>
                            </div>
                            <div class="role-title">Public Viewer</div>
                            <div class="role-description">View public cases</div>
                        </div>
                    </div>
                    <div class="role-card" data-role="2">
                        <div class="role-card-content">
                            <div class="role-icon">
                                <i data-lucide="search"></i>
                            </div>
                            <div class="role-title">Investigator</div>
                            <div class="role-description">Manage investigations</div>
                        </div>
                    </div>
                    <div class="role-card" data-role="3">
                        <div class="role-card-content">
                            <div class="role-icon">
                                <i data-lucide="microscope"></i>
                            </div>
                            <div class="role-title">Forensic Analyst</div>
                            <div class="role-description">Analyze evidence</div>
                        </div>
                    </div>
                    <div class="role-card" data-role="4">
                        <div class="role-card-content">
                            <div class="role-icon">
                                <i data-lucide="scale"></i>
                            </div>
                            <div class="role-title">Legal Professional</div>
                            <div class="role-description">Legal review</div>
                        </div>
                    </div>
                    <div class="role-card" data-role="5">
                        <div class="role-card-content">
                            <div class="role-icon">
                                <i data-lucide="building"></i>
                            </div>
                            <div class="role-title">Court Official</div>
                            <div class="role-description">Court proceedings</div>
                        </div>
                    </div>
                    <div class="role-card" data-role="6">
                        <div class="role-card-content">
                            <div class="role-icon">
                                <i data-lucide="clipboard-list"></i>
                            </div>
                            <div class="role-title">Evidence Manager</div>
                            <div class="role-description">Manage evidence</div>
                        </div>
                    </div>
                    <div class="role-card" data-role="7">
                        <div class="role-card-content">
                            <div class="role-icon">
                                <i data-lucide="audit"></i>
                            </div>
                            <div class="role-title">Auditor</div>
                            <div class="role-description">System auditing</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Form Container -->
            <div id="comprehensiveFormContainer" class="hidden">
                <!-- Form will be generated here -->
            </div>
        </div>

        <!-- Admin Options -->
        <div id="adminOptionsSection" class="card hidden">
            <div class="card-header">
                <div class="card-icon">
                    <i data-lucide="shield-check"></i>
                </div>
                <h2>Administrator Access</h2>
                <p>Welcome back, Administrator!</p>
            </div>
            <div class="user-info">
                <div class="user-avatar">
                    <i data-lucide="crown"></i>
                </div>
                <div class="user-details">
                    <h3 id="adminUserName">Administrator</h3>
                    <span id="adminUserRoleName" class="badge badge-admin">Administrator</span>
                </div>
            </div>
            <div class="card-actions">
                <button onclick="goToAdminDashboard()" class="btn btn-primary">
                    <i data-lucide="settings"></i>
                    Admin Dashboard
                </button>
                <button onclick="logout()" class="btn btn-outline">
                    <i data-lucide="user-plus"></i>
                    Create Account
                </button>
            </div>
        </div>

        <!-- Already Registered -->
        <div id="alreadyRegisteredSection" class="card hidden">
            <div class="card-header">
                <div class="card-icon">
                    <i data-lucide="user-check"></i>
                </div>
                <h2>Welcome Back!</h2>
                <p>Access your dashboard</p>
            </div>
            <div class="user-info">
                <div class="user-avatar">
                    <i data-lucide="user"></i>
                </div>
                <div class="user-details">
                    <h3 id="userName">Loading...</h3>
                    <span id="userRoleName" class="badge">Loading...</span>
                </div>
            </div>
            <div class="card-actions">
                <button id="goToDashboard" class="btn btn-primary">
                    <i data-lucide="arrow-right"></i>
                    Dashboard
                </button>
                <button onclick="logout()" class="btn btn-outline">
                    <i data-lucide="log-out"></i>
                    Switch Account
                </button>
            </div>
        </div>

        <!-- Documentation Section -->
        <div class="documentation-section" id="documentation">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i data-lucide="book-open"></i>
                    </div>
                    <h2>Documentation</h2>
                    <p>Complete guide to using the EVID-DGC system</p>
                </div>
                <div class="doc-grid">
                    <div class="doc-item">
                        <div class="doc-icon">
                            <i data-lucide="play-circle"></i>
                        </div>
                        <h3>Quick Start Guide</h3>
                        <p>Get started with wallet connection and user registration</p>
                    </div>
                    <div class="doc-item">
                        <div class="doc-icon">
                            <i data-lucide="users"></i>
                        </div>
                        <h3>User Roles</h3>
                        <p>Understanding permissions and access levels for each role</p>
                    </div>
                    <div class="doc-item">
                        <div class="doc-icon">
                            <i data-lucide="upload"></i>
                        </div>
                        <h3>Evidence Upload</h3>
                        <p>Step-by-step guide to uploading and managing evidence</p>
                    </div>
                    <div class="doc-item">
                        <div class="doc-icon">
                            <i data-lucide="settings"></i>
                        </div>
                        <h3>API Reference</h3>
                        <p>Technical documentation for developers and integrations</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contributing Section -->
        <div class="contributing-section" id="contributing">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i data-lucide="git-pull-request"></i>
                    </div>
                    <h2>Contributing to EVID-DGC</h2>
                    <p>Join our community and help build the future of evidence management</p>
                </div>
                <div class="contributing-content">
                    <div class="project-info">
                        <div class="project-links">
                            <a href="https://github.com/Gooichand/blockchain-evidence" target="_blank" class="project-link">
                                <i data-lucide="github"></i>
                                <span>GitHub Repository</span>
                            </a>
                            <a href="https://blockchain-evidence.onrender.com/" target="_blank" class="project-link">
                                <i data-lucide="external-link"></i>
                                <span>Live Demo</span>
                            </a>
                            <a href="https://github.com/Gooichand/blockchain-evidence/blob/main/CONTRIBUTING.md" target="_blank" class="project-link">
                                <i data-lucide="book-open"></i>
                                <span>Contributing Guide</span>
                            </a>
                        </div>
                    </div>
                    
                    <div class="contribution-types">
                        <h3>Ways to Contribute</h3>
                        <div class="contrib-grid">
                            <div class="contrib-item">
                                <div class="contrib-icon">
                                    <i data-lucide="bug"></i>
                                </div>
                                <h4>Report Bugs</h4>
                                <p>Help us identify and fix issues</p>
                            </div>
                            <div class="contrib-item">
                                <div class="contrib-icon">
                                    <i data-lucide="lightbulb"></i>
                                </div>
                                <h4>Suggest Features</h4>
                                <p>Propose new functionality</p>
                            </div>
                            <div class="contrib-item">
                                <div class="contrib-icon">
                                    <i data-lucide="code"></i>
                                </div>
                                <h4>Write Code</h4>
                                <p>Contribute to the codebase</p>
                            </div>
                            <div class="contrib-item">
                                <div class="contrib-icon">
                                    <i data-lucide="shield"></i>
                                </div>
                                <h4>Security Review</h4>
                                <p>Help improve system security</p>
                            </div>
                        </div>
                    </div>
                    
                    <div class="mentors-section">
                        <h3>Project Mentors</h3>
                        <div class="mentors-grid">
                            <div class="mentor-card">
                                <div class="mentor-avatar">
                                    <i data-lucide="user"></i>
                                </div>
                                <div class="mentor-info">
                                    <h4>Charu Awasthi</h4>
                                    <p>Lead Mentor</p>
                                    <div class="mentor-links">
                                        <a href="https://github.com/Charu19awasthi" target="_blank">
                                            <i data-lucide="github"></i>
                                        </a>
                                        <a href="https://www.linkedin.com/in/charu-awasthi-6312b6293/" target="_blank">
                                            <i data-lucide="linkedin"></i>
                                        </a>
                                        <a href="mailto:charuawa184@gmail.com">
                                            <i data-lucide="mail"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="mentor-card">
                                <div class="mentor-avatar">
                                    <i data-lucide="user"></i>
                                </div>
                                <div class="mentor-info">
                                    <h4>Pragati Gaykwad</h4>
                                    <p>Technical Mentor</p>
                                    <div class="mentor-links">
                                        <a href="https://github.com/PG-bit997" target="_blank">
                                            <i data-lucide="github"></i>
                                        </a>
                                        <a href="https://www.linkedin.com/in/pragati-gaykwad/" target="_blank">
                                            <i data-lucide="linkedin"></i>
                                        </a>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="get-started">
                        <h3>Get Started</h3>
                        <div class="steps-grid">
                            <div class="step-item">
                                <div class="step-number">1</div>
                                <h4>Fork Repository</h4>
                                <p>Star and fork the GitHub repository</p>
                            </div>
                            <div class="step-item">
                                <div class="step-number">2</div>
                                <h4>Read Guidelines</h4>
                                <p>Review the contributing guide</p>
                            </div>
                            <div class="step-item">
                                <div class="step-number">3</div>
                                <h4>Pick an Issue</h4>
                                <p>Choose from good first issues</p>
                            </div>
                            <div class="step-item">
                                <div class="step-number">4</div>
                                <h4>Submit PR</h4>
                                <p>Create a pull request</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- FAQ Section -->
        <div class="faq-section" id="faq">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i data-lucide="help-circle"></i>
                    </div>
                    <h2>Frequently Asked Questions</h2>
                    <p>Common questions about the EVID-DGC system</p>
                </div>
                <div class="faq-list">
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>What is EVID-DGC?</h3>
                            <i data-lucide="chevron-down"></i>
                        </div>
                        <div class="faq-answer">
                            <p>EVID-DGC is a blockchain-based evidence management system designed for law enforcement, forensic analysts, and legal professionals. It ensures evidence integrity through immutable records and provides role-based access control.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>How secure is the system?</h3>
                            <i data-lucide="chevron-down"></i>
                        </div>
                        <div class="faq-answer">
                            <p>The system uses blockchain technology for immutable records, cryptographic hashing for evidence integrity, and enterprise-grade security measures including role-based access control and audit logging.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>What user roles are available?</h3>
                            <i data-lucide="chevron-down"></i>
                        </div>
                        <div class="faq-answer">
                            <p>The system supports 8 user roles: Public Viewer, Investigator, Forensic Analyst, Legal Professional, Court Official, Evidence Manager, Auditor, and Administrator. Each role has specific permissions and access levels.</p>
                        </div>
                    </div>
                    <div class="faq-item">
                        <div class="faq-question">
                            <h3>Do I need MetaMask to use the system?</h3>
                            <i data-lucide="chevron-down"></i>
                        </div>
                        <div class="faq-answer">
                            <p>MetaMask is required for wallet-based authentication. Alternatively, you can use email and password authentication for easier access.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Contact Section -->
        <div class="contact-section" id="contact">
            <div class="card">
                <div class="card-header">
                    <div class="card-icon">
                        <i data-lucide="phone"></i>
                    </div>
                    <h2>Contact Us</h2>
                    <p>Get in touch with our team for support and inquiries</p>
                </div>
                <div class="contact-grid">
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i data-lucide="mail"></i>
                        </div>
                        <h3>Email Support</h3>
                        <p>support@evid-dgc.com</p>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i data-lucide="phone"></i>
                        </div>
                        <h3>Phone Support</h3>
                        <p>+1 (555) 123-4567</p>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i data-lucide="github"></i>
                        </div>
                        <h3>GitHub</h3>
                        <p><a href="https://github.com/Gooichand/blockchain-evidence" target="_blank">View Repository</a></p>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">
                            <i data-lucide="map-pin"></i>
                        </div>
                        <h3>Location</h3>
                        <p>Global Operations</p>
                    </div>
                </div>
            </div>
        </div>
        <div id="emailLoginModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Email Login</h3>
                    <button class="modal-close" onclick="closeEmailLogin()">
                        <i data-lucide="x"></i>
                    </button>
                </div>
                <form id="emailLoginForm">
                    <div class="form-group">
                        <label for="loginEmail">
                            <i data-lucide="mail"></i>
                            Email Address
                        </label>
                        <input type="email" id="loginEmail" class="form-control" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="loginPassword">
                            <i data-lucide="lock"></i>
                            Password
                        </label>
                        <input type="password" id="loginPassword" class="form-control" placeholder="Enter your password" required>
                    </div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <i data-lucide="log-in"></i>
                            Login
                        </button>
                        <button type="button" class="btn btn-outline" onclick="showEmailRegistration()">
                            <i data-lucide="user-plus"></i>
                            Create Account
                        </button>
                    </div>
                </form>
            </div>
        </div>
        <!-- Email Registration Modal -->
        <div id="emailRegistrationModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h3>Create Account</h3>
                    <button class="modal-close" onclick="closeEmailRegistration()">
                        <i data-lucide="x"></i>
                    </button>
                </div>
                <form id="emailRegistrationForm">
                    <div class="form-group">
                        <label for="regEmail">
                            <i data-lucide="mail"></i>
                            Email Address
                        </label>
                        <input type="email" id="regEmail" class="form-control" placeholder="Enter your email" required>
                    </div>
                    <div class="form-group">
                        <label for="regPassword">
                            <i data-lucide="lock"></i>
                            Password
                        </label>
                        <input type="password" id="regPassword" class="form-control" placeholder="Create a password" required>
                    </div>
                    <div class="form-group">
                        <label for="regConfirmPassword">
                            <i data-lucide="lock"></i>
                            Confirm Password
                        </label>
                        <input type="password" id="regConfirmPassword" class="form-control" placeholder="Confirm your password" required>
                    </div>
                    <div class="form-group">
                        <label for="regFullName">
                            <i data-lucide="user"></i>
                            Full Name
                        </label>
                        <input type="text" id="regFullName" class="form-control" placeholder="Enter your full name" required>
                    </div>
                    <div class="form-group">
                        <label for="regRole">
                            <i data-lucide="users"></i>
                            Role
                        </label>
                        <select id="regRole" class="form-control" required onchange="loadEmailRoleFields()">
                            <option value="">Select your role</option>
                            <option value="1">Public Viewer</option>
                            <option value="2">Investigator</option>
                            <option value="3">Forensic Analyst</option>
                            <option value="4">Legal Professional</option>
                            <option value="5">Court Official</option>
                            <option value="6">Evidence Manager</option>
                            <option value="7">Auditor</option>
                        </select>
                    </div>
                    <div id="emailRoleFields" style="display: none;"></div>
                    <div class="form-actions">
                        <button type="submit" class="btn btn-success">
                            <i data-lucide="user-plus"></i>
                            Create Account
                        </button>
                        <button type="button" class="btn btn-outline" onclick="closeEmailRegistration()">
                            Cancel
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
        <div class="footer-container">
            <div class="footer-section">
                <div class="footer-brand">
                    <i data-lucide="shield-check"></i>
                    <span>EVID-DGC</span>
                </div>
                <p>Secure blockchain evidence management system.</p>
            </div>
            <div class="footer-section">
                <h3>Links</h3>
                <ul>
                    <li><a href="https://github.com/Gooichand/blockchain-evidence" target="_blank">GitHub</a></li>
                    <li><a href="#documentation" onclick="event.preventDefault(); scrollToSection('documentation')">Documentation</a></li>
                    <li><a href="#contact" onclick="event.preventDefault(); scrollToSection('contact')">Support</a></li>
                </ul>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2026 EVID-DGC. All rights reserved.</p>
        </div>
    </footer>

    <!-- Loading Modal -->
    <div id="loadingModal" class="modal">
        <div class="modal-content">
            <div class="spinner"></div>
            <h3>Processing...</h3>
            <p>Please wait...</p>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            lucide.createIcons();
            createParticles();
            initializeEmailLogin();
            initializeFAQ();
        });

        function createParticles() {
            const particles = document.getElementById('particles');
            for (let i = 0; i < 30; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (Math.random() * 10 + 10) + 's';
                particles.appendChild(particle);
            }
        }

        function initializeEmailLogin() {
            const emailLoginForm = document.getElementById('emailLoginForm');
            const emailRegForm = document.getElementById('emailRegistrationForm');
            
            if (emailLoginForm) {
                emailLoginForm.addEventListener('submit', handleEmailLogin);
            }
            
            if (emailRegForm) {
                emailRegForm.addEventListener('submit', handleEmailRegistration);
            }
        }
        
        async function handleEmailLogin(event) {
            event.preventDefault();
            
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            if (email.toLowerCase() === 'gc67766@gmail.com' && password === '@Gopichand1@') {
                const adminData = {
                    email: 'Gc67766@gmail.com',
                    fullName: 'System Administrator',
                    role: 8,
                    department: 'Administration',
                    isRegistered: true,
                    walletAddress: '0x29bb7718d5c6da6e787deae8fd6bb3459e8539f2',
                    loginType: 'email',
                    accountType: 'admin'
                };
                
                localStorage.setItem('emailUser_' + email, JSON.stringify(adminData));
                localStorage.setItem('currentUser', 'email_' + email);
                localStorage.setItem('evidUser_email_' + email, JSON.stringify(adminData));
                
                showAlert('Admin login successful!', 'success');
                displayAdminEmailOptions();
                return;
            }
            
            const savedUser = localStorage.getItem('emailUser_' + email);
            
            if (!savedUser) {
                showAlert('Account not found. Please register first.', 'error');
                return;
            }
            
            const userData = JSON.parse(savedUser);
            
            if (userData.password !== password) {
                showAlert('Invalid password.', 'error');
                return;
            }
            
            localStorage.setItem('currentUser', 'email_' + email);
            localStorage.setItem('evidUser_email_' + email, JSON.stringify(userData));
            
            showAlert('Login successful!', 'success');
            
            setTimeout(() => {
                window.location.href = 'dashboard.html';
            }, 1500);
        }
        
        async function handleEmailRegistration(event) {
            event.preventDefault();
            
            const email = document.getElementById('regEmail').value;
            const password = document.getElementById('regPassword').value;
            const confirmPassword = document.getElementById('regConfirmPassword').value;
            const fullName = document.getElementById('regFullName').value;
            const role = parseInt(document.getElementById('regRole').value);
            
            if (password !== confirmPassword) {
                showAlert('Passwords do not match.', 'error');
                return;
            }
            
            if (password.length < 6) {
                showAlert('Password must be at least 6 characters.', 'error');
                return;
            }
            
            const existingUser = localStorage.getItem('emailUser_' + email);
            if (existingUser) {
                showAlert('Account already exists.', 'error');
                return;
            }
            
            const userData = {
                email,
                password,
                fullName,
                role,
                department: 'General',
                jurisdiction: 'General',
                isRegistered: true,
                registrationDate: new Date().toISOString(),
                loginType: 'email'
            };
            
            localStorage.setItem('emailUser_' + email, JSON.stringify(userData));
            localStorage.setItem('currentUser', 'email_' + email);
            localStorage.setItem('evidUser_email_' + email, JSON.stringify(userData));
            
            showAlert('Registration successful!', 'success');
            closeEmailRegistration();
            
            setTimeout(() => {
                window.location.href = 'dashboard.html';
            }, 1500);
        }
        
        function showEmailRegistration() {
            document.getElementById('emailRegistrationModal').classList.add('active');
        }
        
        function closeEmailRegistration() {
            document.getElementById('emailRegistrationModal').classList.remove('active');
        }
        
        function showEmailLogin() {
            document.getElementById('emailLoginModal').classList.add('active');
        }
        
        function closeEmailLogin() {
            document.getElementById('emailLoginModal').classList.remove('active');
        }
        
        function displayAdminEmailOptions() {
            closeEmailLogin();
            toggleSections('adminOptions');
        }

        function scrollToSection(sectionId) {
            const element = document.getElementById(sectionId);
            if (element) {
                element.scrollIntoView({ behavior: 'smooth' });
            }
        }

        function scrollToTop() {
            window.scrollTo({ 
                top: 0, 
                behavior: 'smooth' 
            });
        }

        function initializeFAQ() {
            const faqItems = document.querySelectorAll('.faq-item');
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                question.addEventListener('click', () => {
                    item.classList.toggle('active');
                });
            });
        }

        function disconnectWallet() {
            userAccount = null;
            document.getElementById('walletStatus').classList.add('hidden');
            document.getElementById('walletSection').classList.remove('hidden');
            document.getElementById('registrationSection').classList.add('hidden');
            document.getElementById('alreadyRegisteredSection').classList.add('hidden');
            
            const connectBtn = document.getElementById('connectWallet');
            if (connectBtn) {
                connectBtn.innerHTML = '<i data-lucide="link"></i> Connect MetaMask';
                connectBtn.disabled = false;
                lucide.createIcons();
            }
            
            showAlert('Wallet disconnected', 'info');
        }
    </script>
</body>

</html>